# CHiLD

## Quick Start

```bash
# 1) create a fresh environment (Python ≥3.10 recommended)
conda create -n child python=3.10
conda activate child

# 2) install dependencies
pip install -r requirements.txt

# 3) install CHiLD in editable mode
pip install -e .
```

## Generate Synthetic Datasets

The generator script builds all synthetic datasets used by the training configs and stores them under `CHiLD/datasets/dataset3/`.

```bash
conda activate child
python CHiLD/tools/gen.py  --seed 773   
```

After the script finishes you should see directories such as `CHiLD/datasets/dataset3/A/`, `M/`, `P/`, each containing `data.npz` and transition matrices (`W*.npy`).

## Configuration Files

The training script uses YAML configuration files located in `CHiLD/configs/`. Available configurations include A.yaml, B.yaml, C.yaml, etc.

## Train a Model

1. Log in to Weights & Biases (required for online logging):
   ```bash
   conda activate child
   wandb login
   ```
   Update the `WANDB` block in `CHiLD/configs/*.yaml` with your own `ENTITY` and `PROJ_NAME`, or export `WANDB_ENTITY` / `WANDB_PROJECT` before launching training.

2. Generate data with 
    ```bash
    python CHiLD/tools/gen.py
    ```
    and verify the expected folder exists under `CHiLD/datasets/dataset3/`.

3. Launch training from the repository root:
   ```bash
   python scripts/train_instantaneous.py -e A -d A -s 770
   ```
   - `-e / --exp` selects a YAML config in `CHiLD/configs/`.
   - `-d / --data` chooses the dataset folder (e.g., `A`, `M`, `P`).
   - `-s / --seed` controls random seed.
   - Append `--disable-wandb` if you prefer to run completely offline.

   Checkpoints, logs, and Lightning outputs are saved under `./log/<user>/<exp>/`.

## Repository Layout

- `CHiLD/`
  - `configs/` – YAML configs that describe datasets, model sizes, and training hyperparameters.
  - `datasets/` – Synthetic datasets generated by `CHiLD/tools/gen.py`.
  - `modules/` – PyTorch Lightning modules and model components.
  - `tools/` – Data generation utilities (`gen.py`, `gen_data.py`, etc.).
- `scripts/`
  - `train_instantaneous.py` – Main training entry point.
  - `*_timing.py`, `*_test.py` – Auxiliary evaluation scripts.
- `requirements.txt` – Python dependency list.
- `setup.py` – Editable install configuration.

For additional environment details, consult `README_ENVIRONMENT.md`.
